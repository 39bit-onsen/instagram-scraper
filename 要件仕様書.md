## Instagram専用：ハッシュタグスクレイピング要件仕様書

### ■ 目的

Instagram上で使用されているハッシュタグに関する情報（投稿数・投稿傾向・関連タグ）を収集し、ターゲット層の検索行動・投稿傾向・コンテンツ設計の参考とする。

---

### ■ 取得対象と項目

| カテゴリ     | 取得項目                  | 必須 | 説明                      |
| -------- | --------------------- | -- | ----------------------- |
| ハッシュタグ情報 | タグ名（#citywalkhk など）   | ✔  | ユーザー検索入力に対応。最大30文字程度    |
|          | 投稿件数（例：134,000 posts） | ✔  | タグ検索結果画面に表示される数字        |
|          | 関連タグ候補（2〜10件）         | ◯  | 検索入力時のサジェスト or 投稿内の共起タグ |
| 投稿情報     | 上位表示投稿（TOP9〜12件）URL一覧 | ◯  | ハッシュタグ検索画面のトップ投稿群       |
|          | 各投稿のURL／画像URL         | ◯  | 保存して可視化・資料化に使用          |
|          | 各投稿の「いいね数」「コメント数」     | △  | 投稿人気度分析の補助指標（公開されていれば）  |
| 投稿構成     | 投稿の種別（画像／動画／リール）      | ◯  | 表示位置・形式の分類に使用           |
| 投稿本文抜粋   | キャプション冒頭20〜50文字       | △  | 内容傾向のスナップショットとして使用      |

---

### ■ サーチ条件・範囲

- **検索キーワード**：事前に用意したタグリスト or 手動入力（CSV・JSONで複数処理可能）
- **収集件数**：1タグあたりトップ9〜12投稿を上限に
- **対象条件**：
  - 公開アカウントのみ
  - 投稿日時制限なし（必要に応じて直近1週間などで絞る）

---

### ■ 技術仕様（実装案）

| 項目        | 内容                                               |
| --------- | ------------------------------------------------ |
| 使用言語      | Python（Selenium、Playwright）推奨                    |
| データ形式     | CSV／JSON（例：tag\_name, post\_count, urls）         |
| アクセス手段    | ブラウザ自動操作（Instagramは動的コンテンツ）                      |
| セッション方式   | ユーザーがInstagramに手動ログインし、Seleniumでcookieを保存・再利用する  |
| cookie取得例 | `driver.get_cookies()` → JSONファイルに保存／再読み込みで認証を維持 |
| 更新頻度      | セッション有効期限（通常数日〜2週間）に応じて手動再ログイン・cookie再取得が必要      |

---

### ■ 出力例（CSVイメージ）

```
tag_name,post_count,related_tags,top_post_urls,post_type,caption_snippet
citywalkhk,134000,"['#hongkongtrip','#街歩き','#映えスポット']",["https://...","..."],"image","週末に友達と..."
```

---

### ■ 制限・注意事項

- Instagramは**非公式なスクレイピングを制限**しており、**Graph APIは使用しない前提**
- ログイン済みセッション（cookie）を再利用し、ログイン状態を保ったまま取得する必要あり
- 頻繁なアクセス・多数のタグ取得はブロック対象になる可能性があるため、**低頻度＆人間らしい待機・動作**を前提に設計
- DOM構造変更などに備え、セレクタは関数化・変化に柔軟な設計にする

---

### ■ 応用例（マーケ活用シナリオ）

| 活用シーン     | 活用例                           |
| --------- | ----------------------------- |
| ハッシュタグ設計  | 自社投稿に適したタグ選定（競合が使うミドルレンジタグ抽出） |
| 投稿内容の参考   | タグごとにどんな写真／トーン／構成が人気かを分析      |
| KOL選定の補助  | トップ投稿から有力インフルエンサーを発見          |
| タグトレンド可視化 | 週次投稿数の増減を見てトレンド性のあるタグを選別      |

---

この仕様をもとに、Pythonスクリプト設計、取得用テンプレート作成、cookie管理機構の導入、定期実行設定（cronなど）へ進めることができます。

